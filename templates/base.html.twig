<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <title>{% block title %}Portál značkaře{% endblock %}</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 128 128%22><text y=%221.2em%22 font-size=%2296%22>⛰️</text></svg>">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    {% block stylesheets %}
        {{ encore_entry_link_tags('app-styles') }}
    {% endblock %}
</head>

<body>
    <div class="app-shell">
        <!-- Header -->
        <header class="app-header">
            <div class="app-header__brand">
                <button class="burger" onclick="toggleNavbar()" aria-label="Otevřít/zavřít menu">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
                <a href="{{ path('app_index') }}" class="logo">Portál značkaře</a>
            </div>
            
            <div class="app-header__actions">
                <button class="btn-icon" onclick="toggleTheme()" aria-label="Přepnout tmavý/světlý režim">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                        <circle cx="12" cy="12" r="5"/>
                        <path d="M12 1v2M12 21v2M4.2 4.2l1.4 1.4M18.4 18.4l1.4 1.4M1 12h2M21 12h2M4.2 19.8l1.4-1.4M18.4 5.6l1.4-1.4"/>
                    </svg>
                </button>
                
                {% if app.user %}
                    <div class="user-widget">
                        <span>{{ app.user.jmeno }} {{ app.user.prijmeni }}</span>
                        <a href="{{ path('api_auth_logout') }}" class="btn-icon" onclick="return confirm('Opravdu se chcete odhlásit?')">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/>
                                <polyline points="16,17 21,12 16,7"/>
                                <line x1="21" y1="12" x2="9" y2="12"/>
                            </svg>
                        </a>
                    </div>
                {% else %}
                    <a href="{{ path('app_dashboard') }}" class="btn btn--primary">Přihlásit se</a>
                {% endif %}
            </div>
        </header>

        <div class="app-content">
            <!-- Navbar -->
            <nav class="app-navbar" id="navbar">
                <a href="{{ path('app_index') }}" class="nav-link {{ app.request.attributes.get('_route') == 'app_index' ? 'active' : '' }}">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                        <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/>
                        <polyline points="9,22 9,12 15,12 15,22"/>
                    </svg>
                    Úvod
                </a>
                
                <a href="{{ path('app_metodika') }}" class="nav-link {{ app.request.attributes.get('_route') == 'app_metodika' ? 'active' : '' }}">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                        <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"/>
                        <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"/>
                    </svg>
                    Metodika
                </a>
                
                <a href="{{ path('app_downloads') }}" class="nav-link {{ app.request.attributes.get('_route') == 'app_downloads' ? 'active' : '' }}">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                        <polyline points="7,10 12,15 17,10"/>
                        <line x1="12" y1="15" x2="12" y2="3"/>
                    </svg>
                    Ke stažení
                </a>

                {% if app.user %}
                    <div class="nav-divider"></div>
                    
                    <a href="{{ path('app_dashboard') }}" class="nav-link {{ app.request.attributes.get('_route') == 'app_dashboard' ? 'active' : '' }}">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
                            <path d="M9 9h6v6H9z"/>
                        </svg>
                        Moje nástěnka
                    </a>
                    
                    <a href="{{ path('app_prikazy') }}" class="nav-link {{ app.request.attributes.get('_route') starts with 'app_prikaz' ? 'active' : '' }}">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                            <path d="M9 11l3 3L22 4"/>
                            <path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"/>
                        </svg>
                        Příkazy
                    </a>
                    
                    <a href="{{ path('app_profil') }}" class="nav-link {{ app.request.attributes.get('_route') == 'app_profil' ? 'active' : '' }}">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                            <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
                            <circle cx="12" cy="7" r="4"/>
                        </svg>
                        Profil
                    </a>
                    
                    <div class="nav-divider"></div>
                    
                    <a href="{{ path('help_index') }}" class="nav-link {{ app.request.attributes.get('_route') starts with 'help_' ? 'active' : '' }}">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                            <circle cx="12" cy="12" r="10"/>
                            <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/>
                            <line x1="12" y1="17" x2="12.01" y2="17"/>
                        </svg>
                        Nápověda
                    </a>
                {% endif %}
            </nav>

            <!-- Main content -->
            <main class="app-main">
                {% block body %}{% endblock %}
            </main>
        </div>
    </div>

    <script>
        // Theme toggle
        function toggleTheme() {
            const html = document.documentElement;
            const isDark = html.classList.contains('dark');
            
            // Odstraň všechny theme třídy
            html.classList.remove('light', 'dark');
            
            if (isDark) {
                // Přepni na light
                localStorage.setItem('theme', 'light');
            } else {
                // Přepni na dark
                html.classList.add('dark');
                localStorage.setItem('theme', 'dark');
            }
        }
        
        // Load saved theme on page load
        const savedTheme = localStorage.getItem('theme') || 'light';
        if (savedTheme === 'dark') {
            document.documentElement.classList.add('dark');
        }
        // Light mode je default (žádná třída)
        
        // Navbar toggle
            function toggleNavbar() {
                const navbar = document.getElementById('navbar');
                navbar.classList.toggle('open');
            }
            
            // Close navbar on mobile when clicking outside
            document.addEventListener('click', function(e) {
                const navbar = document.getElementById('navbar');
                const burger = document.querySelector('.burger');
                
                if (window.innerWidth < 768 && 
                    !navbar.contains(e.target) && 
                    !burger.contains(e.target) && 
                    navbar.classList.contains('open')) {
                    navbar.classList.remove('open');
                }
            });
    </script>

    {% block javascripts %}
        {# JavaScript entries budou načítány podle potřeby v konkrétních šablonách #}
    {% endblock %}
</body>
</html>